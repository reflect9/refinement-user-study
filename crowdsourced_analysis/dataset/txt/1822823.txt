iran may have trained attackers that killed 5 american soldiers, u.s. and iraqis say   investigators say they believe that attackers who used american-style uniforms and weapons to infiltrate a secure compound and kill five american soldiers in karbala on jan. 20 may have been trained and financed by iranian agents, according to american and iraqi officials knowledgeable about the inquiry.  the officials said the sophistication of the attack astonished investigators, who doubt that iraqis could have carried it out on their own -- one reason a connection to iran is being closely examined. officials cautioned that no firm conclusions had been drawn and did not reveal any direct evidence of a connection.  a senior iraqi official said the attackers had carried forged american identity cards and american-style m-4 rifles and had thrown stun grenades of a kind used only by american forces here.  tying iran to the deadly attack could be helpful to the bush administration, which has been engaged in an escalating war of words with iran.  one american soldier was killed during the initial attack and four more were abducted and killed shortly afterward as the police pursued the sport utility vehicles used in the attack.  the attack was focused on a meeting at a joint security station, where american and iraqi forces mesh their efforts in the new security plan.  an iraqi knowledgeable about the investigation said four suspects had been detained and questioned. based on those interviews, investigators have concluded that as they fled karbala with the abducted americans, the attackers used advanced devices to monitor police communications and avoid the roads where the police were searching.  the suspects have also told investigators that ''a religious group in najaf'' was involved in the operation, the iraqi said, in a clear reference to the mahdi army, the militia controlled by the breakaway shiite cleric, moktada al-sadr. if that information holds up, it would dovetail with assertions by several iraqi officials that iran is financing and training a small number of splinter groups from the mahdi army to carry out special operations and assassinations.  ''i hear that there are a number of commando and assassination squads that are disconnected and controlled directly by iran,'' the senior iraqi official said, citing information directly from the prime minister's office. ''they have supplied jam and others with significant weaponry and training,'' he said using shorthand for the group, from its name in arabic, jaish al mahdi.  confirmation of a mahdi army connection to the deadly incident would also support the argument by bush administration officials that the group has a direct role in attacks on american troops.  another senior iraqi official said that military actions by the united states against jam essentially pushed it toward iran.  ''during the conflicts between the mahdi army and the united states, iran was the only side that supported jam,'' the official said. ''and they told them, 'hey, we are here to help you and we are here to support you, and we will not let you down.' ''  the karbala operation involved 9 to 12 armed militants and at least five sport utility vehicles, the american military has said. the initial attack on the compound killed one american soldier and damaged three humvees, the military said.  but what has caught the attention of investigators is the way the convoy of s.u.v.'s was able to give the impression that it was american and slip through iraqi checkpoints unchallenged. an american military official said all possibilities were being explored, with the focus on whom the united states can trust, even among senior iraqi officials, in the karbala area.  ''we've got to be very careful as to who we define as our allies, and who we trust and who we don't,'' the military official said. ''was the governor involved? were the iraqi police that were on guard complicit or just incompetent?''  the unusual nature of the attack has made it a major topic of discussion in the upper echelons of the iraqi government. it has spawned bizarre theories including the idea that a western mercenary group was somehow involved.  but the existence of what american commanders sometimes call ''rogue jam'' -- separate from the central, controlled militia -- has put the mahdi army at the center of the investigation, officials say.  two american officials in washington confirmed that american military investigators were looking into the possibility of iranian involvement in the karbala attack. one of those officials said the working assumption by the investigators was that the operation had been carried out by a splinter group of the mahdi army.  the second official said the operation could be seen as retribution for three recent american raids in which iranians suspected of carrying out attacks on american and iraqi forces were detained. on sunday, the iranian ambassador to iraq conceded that two iranians detained in baghdad last month were security officials, but said that they were making legitimate contacts with iraqi government officials.  